<div dir="rtl">

## سیستم مدیریت محتوا میشکا ساخته شده با زبان برنامه نویسی الیکسیر و فریمورک فونیکس

پروژه **میشکا** یک **سیستم مدیریت محتوا** یا **CMS** ریل تایم و همینطور **API** محور می باشد که با زبان [الیکسیر](https://elixir-lang.org/) توسعه داده شده است و همینطور قدرت گرفته با فریم ورک [فونیکس](https://phoenixframework.org/) می باشد.
لازم به ذکر است در این پروژه سعی شده است بیشتر وابستگی ها داخل خود زبان الیکسیر باشد و از سیستم های خارجی زیاد استفاده نگردد و تا به حال نیز به همین روال بوده جز در مبحث دیتابیس که از [پستگرس](https://www.postgresql.org/) استفاده شده است

> این سیستم، مدیریت محتوا رایگان و متن باز می باشد و هم اکنون در فاز توسعه و آزمایش قرار دارد لطفا در پروژه های واقعی خود با دقت از آن استفاده کنید. اگر به زبان الیکسیر و دپلوی آن آشنایی ندارید نگران نباشید شما می توانید از پکیج های آماده داکر برای این پروژه استفاده کنید که همه کار های پیاده سازی روی سیستم شما در فاز توسعه و محصول را انجام می دهد

---

## زیر سیستم های پروژه:

cms میشکا با اسم انگلیسی `mishka-cms` به صورت دامین درایو درست گردیده (`DDD`) که دارای ۶ زیر سیستم تا به حال می باشد که برخی از آن ها هنوز توسعه کامل پیدا نکردند. زیر سیستم ها برای آشنایی به شرح زیر می باشند:

1. **زیر سیستم API**:  این بخش برای ارائه `API` به نرم افزار های خارجی می باشد و تقریبا تمامی بخش های ساخته شده را در بر می گیرد. این بخش به واسطه توکن در بیشتر `endpoint` ها ارتباط برقرار می کند و ارسال داده و دریافت آن به صورت `Json` می باشد. به زودی `API` های مربوط به ارتباط ریل تایم نیز به آن اضافه می گردد.

2.  **زیر سیستم HTML**:  در این بخش همانند زیر سیستم `API` ارتباط در بخش کاربری و به صورت خلاصه سایت گرافیکی را در بر می گیرد و دارای پنل ادمین و همینطور قالب نمونه برای قسمت کاربری می باشد. کاملا با `Phoenix LiveView` درست شده است و تک صفحه ای بدون رفرش و ریل تایم می باشد. در این بخش ارتباط های زیادی نیز به وسطه `GenServer` درست شده است و دارای سیستم کشینگ می باشد. لازم به ذکر هست بخش های بزرگی از این پروژه به صورت استیت فول می باشد و به زودی نیز این بخش ها بزرگتر خواهند شد.

3. **زیر سیستم مدیریت فایل**: این بخش هنوز وارد مرحله توسعه نشده است ولی هدف از ساخت آن بکاپ گیری فایل ها و همینطور مدیریت فایل می باشد در حقیقت یک مدیامنیجر می باشد؛ با آپلود ریل تایم و همینطور مدیریت فایل های کاربری. این بخش پنل مربوط به آپلود نیز در اختیار بخش کاربری نیز قرار می دهد که احساس نیاز به `ftp` را کامل برطرف می کند

4. **زیر سیستم مدیریت محتوا**: هدف اصلی این سیستم نیز مدیریت کردن محتوا می باشد به همین منظور این بخش به صورت مستقل می باشد و کار ویرایش و ارسال محتوا به سایت را بر عهده دارد. لازم به ذکر است این سیستم می تواند در آینده به خیلی از بخش های دیگری که به صورت پروژه مستقل اضافه می شوند نیز متصل گردد. بخاطر اینکه قسمت بوکمارک و همینطور اشتراک و ارسال نظر و دیدن نظر به صورت عمومی درست گردیده است تا بخش های زیادی از این سیستم را پوشش بدهد و نیاز به ساخت افزونه مجدد نباشد. هدف در فاز های بعدی این هست که این سیستم قدرت ویرایش و ارسال محتوا را به صورت میکروبلاگ نیز به کاربران بدهد و بسیار قابل کنترل باشد.

5. **زیر سیستم مدیریت کاربران**: همانطور که از نام این بخش مشخص است کاربران از ثبت نام تا ساخت پروفایل را مدیریت می کند و همینطور دسترسی بخش های پروژه نیز در این بخش تعریف می گردد و تخصیص می یابد

6. **زیر سیستم مدیریت بانک اطلاعاتی**: در این سیستم چندین نوع ذخیره سازی و نگهداری موقت و دائمی اطلاعات وجود دارد و همینطور مسئولیت بکاپ گیری نیز در این بخش بسیار مهم می باشد. تمامی بخش های که در این پروژه به وجود می آیند یا به عنوان زیر سیستم قرار پیاده سازی می شوند نیز باید در این بخش معرفی شوند و تست گردند. این بخش می توانید بعدا به صورت میکروسرویس نیز استفاده گردد. این بخش به صورت پیشفرض از `پستگرس` و برای کش از `GenServer` استفاده می کند


---
برای آشنایی بیشتر می توانید پلی لیست در حال به روز رسانی سیستم مدیریت محتوا میشکا را در یوتیوب ببنید:

[https://www.youtube.com/playlist?list=PL4jyqCsJDmVQpf52hRTTMwuLvtOu2dx0j](https://www.youtube.com/playlist?list=PL4jyqCsJDmVQpf52hRTTMwuLvtOu2dx0j)

---

لازم به ذکر است شما می توانید در بخش پلن های ما برنامه آینده و همینطور امکاناتی که قرار است در هر نسخه اضافه شود را مشاهده کنید
[https://github.com/mishka-group/mishka-cms/projects](https://github.com/mishka-group/mishka-cms/projects)

> برای تست این سیستم مدیریت محتوا فایل `seeds` درست گردیده است که در موقع اجرار پروژه به واسطه پکیج  در بانک اطلاعاتی شما قرار می گیرد که شامل مطالب تست و همینطور یوزر تست می باشد

لطفا در صورتی که خطایی در برنامه دیدید یا اینکه امکاناتی مدنظر شما می باشد لطفا در بخش issues پروژه مارا مطلع فرمایید همکاری شما در این پروژه متن باز رایگان می تواند بسیار تاثیر گزار باشد

[https://github.com/mishka-group/mishka-cms/issues](https://github.com/mishka-group/mishka-cms/issues)

> بعد از انتشار ورژن 0.0.1 پکیج حالت پروداکشن برای داکر نیز در بخش پکیج ها قرار می گیرد که آماده استفاده در پروژه های شما می باشد. در صورتی که می خواهید در پروژه همکاری کنید و نمی دانید از کجا شروع کنید. می توانید با پروفایل زیر در ارتباط باشید
https://github.com/shahryarjb


---

> در آینده امکانات مربوط به این سیستم مدیریت محتوا در مطالب و ویدیو های بیشتر توضیح داده می شود و اگر می خواهید تست در پروژه انجام دهید کافی هست در کنسول الیکسیر دستور `mix test` را بزنید بعدا این بخش به قسمت action گیتهاب متصل خواهد شد تا کار برای شما خودکار گردد

### نسخه های مورد استفاده:

<div dir="ltr">
  
```elixir
- Elixir 1.12.0 (compiled with Erlang/OTP 24)
- Postgres v13
```
  
</div>
  
---

### راه اندازی:

بعد از نصب وابستگی های بالا حال می توانید با این چند دستور پروژه را بالا بیاورید

<div dir="ltr">
 
```elixir
mix ecto.create # اول باید در فایل کانفیگ اطلاعات دیتابیس خود را وارد کنید
mix ecto.migrate
mix deps.get
mix deps.compile
mix assets.deploy
mix test
mix run apps/mishka_database/priv/repo/seeds.exs # در صورتی که می خواهید مطالب و کاربر آزمایشی درست شود. فقط یک بار اجرا شود
iex -S mix phx.server # هر سری که می خواهید سرور را اجرا کنید
```

</div>
  
### اجررا و نصب در چند کلیک به کمک داکر

- اولین مرحله پروژه را دانلود کرده یا از گیت کلون نمایید
- در مرحله بعدی لطفا به مسیر و دایرکتوری `cd mishka-cms/deployment/docker` بروید
- حال دستور `chmod +x mishka.sh` را اجرا کنید
- و در این مرحله می توانید نصب را با کامند `./mishka.sh --build` شروع کنید

> شما در دو محیط می توانید برنامه را نصب و اجرا کنید. حالت اول `dev` می باشد و تمامی تنظیمات به صورت پیشفرض در برنامه قرار خواهد گرفت در این حالت برنامه میشکا برروی آدرس لوکال `127.0.0.1` قابل دسترس خواهد بود.

### در صورتیکه که چیزی وارد نکنید و دکمه `enter` را بزنید به صورت پشفرض حالت `dev` اجرا خواهد شد

> نکته: زمانیکه برنامه در این حالت اجرا شود در طی زمان نصب هیچگونه ورودی از شما نخواهد گرفت.

<div dir="ltr">

```elixir

Choose Environment Type ['prod or dev, defualt is dev']

```

</div>

> بعد از انتخاب نوع نصب. ایمیج شروع به ساخته شدن می کند. زمانیکه عملیات با موفقیت به اتمام برسد پیام زیر به شما نمایش داده خواهد شد

- بخش سبز رنگ آدرسهای مربوط به برنامه 
- بخش زرد رنگ نام کاربری و رمز عبور مربوط به دیتابیس
- بخش قرمز رنگ کلیدهای مربوط به برنامه 
- جهت بالا آوردن Mishka CMS می توانید آدرس زیر را در مرورگر خود وارد نمایید: `127.0.0.1:4000` و همینطور `API` را با پرت 4001

---

 حالت دوم  `prod` می باشد. تنظیمات مرحله به مرحله از شما سؤال خواهد شد در صورتیکه شما مقداری وارد نکنید و دکمه `enter` را بزنید مقادیر پیشفرض در تنظیمات قرار خواهد گرفت.
در ترمینال خود در چند مرحله نام کاربری، کلمه عبور و نام دیتابیسی که برنامه به آن متصل می شود از شما سؤال خواهد شد
همچنین نام کاربری و کلمه عبور مربوط به دیتابیس پستگرس نیز که از آن بعنوان کاربر `root` در دیتابیس استفاده می شود نیز پرسیده می شود.

> نکته: در این حالت توصیه می شود تا مقادیر درخواست شده را در هر مرحله وارد کنید تا از مشکلات امنیتی برای برنامه شما وجود نیاید
> در این مرحله شما باید آدرس IP ، نام دامنه یا ساب مورد نظر خود را وارد کنید. آدرس IP می تواند مربوط به شبکه داخلی یا خارجی مثل یک سرور باشد 

### مثال

<div dir="ltr">

```
127.0.0.1
192.168.1.10
172.16.16.10
10.0.5.150
94.94.94.94
86.86.86.86
.
.
.
example.com
test.example.com
```

</div>

> نکته: در صورتیکه شما آدرس IP وارد کنید در پایان عملیات نصب،‌ برنامه برروی دو پورت 4000 برای CMS و 4001 برای API قابل دسترس خواهد بود. در غیر این صورت مرحله بعدی جهت گرفتن آدرس برای سرویس API نیز نمایش داده خواهد شد.

#### نکته: نام دامنه یا ساب دامنه API  با مرحله قبلی که مربوط به CMS بوده است باید متفاوت باشد

<div dir="ltr">

```
api.example.com
test2.example.com
```
</div>

بعد از اتمام عملیات می توانید آدرس های نمایش داده شده را در مرورگر وارد نمایید. لازم به ذکر است بعد از موفقیت آمیز بودن مراحل شما می توانید تصاویر از پنل ادمین که در آخر محتوا قرار داده شده را ببنید و همینطور اگر آدرس بخش `API` را بزنید می توانید ارور زیر را ببنید

<div dir="ltr">

```elixir
{"errors":{detail":"Not Found"}}
```

</div>


### فعال سازی ssl برای محیط پروداکشن

در صورتیکه شما برای آدرس CMS و  API دامنه یا ساب دامنه ای فعال کرده باشید وارد مرحله بعدی خواهید شد که از شما سوالی در رابطه با فعال سازی SSL پرسیده خواهد شد

پیام:

<div dir="ltr">

```elixir
Do You Want to Enable SSL? (YES/NO) [default is Yes]:
```
</div>

> در صورتیکه پاسخ سؤال بالا هر yes باشد در مرحله بعدی از شما آدرس ایمیلی پرسیده می شود تا زمانیکه گواهی های SSL در حال منقضی شدن بود از سمت Let'secrypt برای شما ایمیلی ارسال گردد.

<div dir="ltr">

```elixir

Enter Your Email Address:

```
</div>

> در صورتیکه پاسخ سؤال فعال سازی SSL هر کلمه ای غیر از yes باشد گواهی ssl برای دامنه های شما تولید نخواهد شد.
---

### تصویر از پنل ادمین

![mishka-cms-admin](https://user-images.githubusercontent.com/8413604/129250846-35abcf82-bb65-432b-98be-e7a025607415.png)

### تصویر از قالب نمونه سایت

![mishka-cms-home-page](https://user-images.githubusercontent.com/8413604/129250980-ce45c35e-389a-435a-bf95-2829c7323862.png)

</div>